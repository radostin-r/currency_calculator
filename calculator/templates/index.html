<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Currency calculator</title>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

{% block javascript %}
<script>


    function calculateAmount() {
        var fromCurrency = document.getElementById("id_from_currency").value;
        var toCurrency = document.getElementById("id_to_currency").value;
        var amount = document.getElementById("id_amount").value;
        $.ajax({
            url: '{% url "calculate" %}',
            data: {'from_currency': fromCurrency, 'to_currency': toCurrency, 'amount': amount},
            dataType: 'json',
            success: function(result) {
                var amount = document.getElementById("result_amount");
                amount.value = result.result_amount;
            },
            error: function() {
                alert("Something went wrong");
            }
        })
    }
</script>
{% endblock %}

<body>
    <table>
        <tr>
            <td>Currency pair</td>
            <td>Exchange rate</td>
        </tr>
        {% for pair in data %}
            <tr>
                <td> {{ pair.currency_pair }} </td>
                <td> {{ pair.exchange_rate }} </td>
            </tr>
        {% endfor %}
    </table>

    <form>
        {% csrf_token %}
        {{ form.as_p }}
        <input type="button" value="Calculate" onclick="javascript:calculateAmount()">
    </form>
    <label>Result amount</label>
    <input type="text" id="result_amount" name="result_amount">
</body>
</html>